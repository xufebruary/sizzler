<!-- content -->
<div class="content ds-manage wrapper-xl no-padding" ui-view>
    <header class="ds-manage-header m-b-n-sm">
        <ol class="ds-header-breadcrumb m-b-none">
            <span class="text-black-1000">权限管理</span>
        </ol>
    </header>
    <br/>
    <tabset class="tab-container">
        <tab heading="Operation">
            <div class="wrapper-md">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="panel panel-default">
                            <div class="panel-heading font-bold">Operation list</div>
                            <table class="table table-striped m-b-none">
                                <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Code</th>
                                    <th>Status</th>
                                    <th>Update</th>
                                </tr>
                                </thead>
                                <tr ng-repeat="operation in permission.operationList">
                                    <td><input type="text" ng-model="operation.name" class="form-control"/></td>
                                    <td><input type="text" ng-model="operation.code" class="form-control"/></td>
                                    <td ng-bind="operation.status"></td>
                                    <td><a class="btn btn-success" ng-click="updateOperation(operation)">Update</a></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="panel panel-default">
                            <div class="panel-heading font-bold">Add operation</div>
                            <div class="panel-body">
                                <form role="form">
                                    <div class="form-group">
                                        <input type="text" ng-model="permission.operation.name" class="form-control"
                                               placeholder="Operation name"/>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" ng-model="permission.operation.code" class="form-control"
                                               placeholder="Operation code"/>
                                    </div>
                                    <button type="button" class="btn btn-primary" ng-click="addOperation()">Add</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </tab>
        <tab heading="Resource">
            <div class="wrapper-md">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="panel panel-default">
                            <div class="panel-heading font-bold">Resource list</div>
                            <table class="table table-striped m-b-none">
                                <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Code</th>
                                    <th>Status</th>
                                    <th>Update</th>
                                </tr>
                                </thead>
                                <tr ng-repeat="resource in permission.resourceList">
                                    <td><input type="text" ng-model="resource.name" class="form-control"/></td>
                                    <td><input type="text" ng-model="resource.code" class="form-control"/></td>
                                    <td ng-bind="resource.status"></td>
                                    <td><a class="btn btn-success" ng-click="updateResource(resource)">Update</a></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="panel panel-default">
                            <div class="panel-heading font-bold">Add resource</div>
                            <div class="panel-body">
                                <form role="form">
                                    <div class="form-group">
                                        <input type="text" ng-model="permission.resource.name" class="form-control"
                                               placeholder="Resource name"/>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" ng-model="permission.resource.code" class="form-control"
                                               placeholder="Resource code"/>
                                    </div>
                                    <button type="button" class="btn btn-primary" ng-click="addResource()">Add</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </tab>
        <tab heading="Permission">
            <div class="wrapper-md">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="panel panel-default">
                            <div class="panel-heading font-bold">Permission list</div>
                            <table class="table table-striped m-b-none">
                                <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Code</th>
                                    <th>Url</th>
                                    <th>Status</th>
                                    <th>Description</th>
                                    <th>Update</th>
                                </tr>
                                </thead>
                                <tr ng-repeat="permission in permission.permissionList">
                                    <td><input type="text" ng-model="permission.name" class="form-control"/></td>
                                    <td><input type="text" ng-model="permission.code" class="form-control"/></td>
                                    <td><input type="text" ng-model="permission.url" class="form-control"/></td>
                                    <td ng-bind="permission.status"></td>
                                    <td><input type="text" ng-model="permission.description" class="form-control"/></td>
                                    <td><a class="btn btn-success" ng-click="updatePermission(permission)">Update</a></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="col-sm-12">
                        <div class="panel panel-default">
                            <div class="panel-heading font-bold">Add permission</div>
                            <div class="panel-body">
                                <form role="form">
                                    <div class="form-group">
                                        <input type="text" ng-model="permission.permission.name" class="form-control"
                                               placeholder="Permission name"/>
                                    </div>
                                    <div class="form-inline form-group">
                                        <select class="form-control" ng-model="permission.select_resource" placeholder="Resource"
                                                ng-change="changePermissionCode()"
                                                ng-options="resource.code for resource in permission.resourceList"></select>

                                        <select class="form-control" ng-model="permission.select_operation" placeholder="Operation"
                                                ng-change="changePermissionCode()"
                                                ng-options="operation.code for operation in permission.operationList"></select>
                                        <label>permission code: </label>
                                        <span ng-bind="permission.permission.code"></span>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" ng-model="permission.permission.url" class="form-control"
                                               placeholder="Permission url"/>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" ng-model="permission.permission.description" class="form-control"
                                               placeholder="Permission description"/>
                                    </div>
                                    <button type="button" class="btn btn-primary" ng-click="addPermission()">Add</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </tab>

        <tab heading="Role">
            <div class="wrapper-md">
                <div class="row" ng-if="!permission.showRoleDetail">
                    <div class="col-sm-10">
                        <div class="panel panel-default">
                            <div class="panel-heading font-bold">Role list</div>
                            <table class="table table-striped m-b-none">
                                <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Code</th>
                                    <th>Status</th>
                                    <th>Description</th>
                                    <th>Update</th>
                                    <th>Edit</th>
                                </tr>
                                </thead>
                                <tr ng-repeat="role in permission.roleList">
                                    <td><input type="text" ng-model="role.name" class="form-control"/></td>
                                    <td><input type="text" ng-model="role.code" class="form-control"/></td>
                                    <td ng-bind="role.status"></td>
                                    <td><input type="text" ng-model="role.description" class="form-control"/></td>
                                    <td><a class="btn btn-success" ng-click="updateRole(role)">Update</a></td>
                                    <td><a class="btn btn-primary" ng-click="editRolePermission(role)">Edit</a></td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    <div class="col-sm-2">
                        <div class="panel panel-default">
                            <div class="panel-heading font-bold">Add role</div>
                            <div class="panel-body">
                                <form role="form">
                                    <div class="form-group">
                                        <input type="text" ng-model="permission.role.name" class="form-control"
                                               placeholder="role name"/>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" ng-model="permission.role.code" class="form-control"
                                               placeholder="role code"/>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" ng-model="permission.role.description" class="form-control"
                                               placeholder="role description"/>
                                    </div>
                                    <button type="button" class="btn btn-primary" ng-click="addRole()">Add</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" ng-if="permission.showRoleDetail">
                    <div class="col-sm-10">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                {{permission.currentRole.name}}
                            </div>
                            <table class="table table-striped m-b-none">
                                <thead>
                                <tr>
                                    <th></th>
                                    <th>Name</th>
                                    <th>Description</th>
                                </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="permission in permission.permissionList" on-finish-render-filters>
                                        <td><input type="checkbox" value="{{permission.permissionId}}" class="permissionList"></td>
                                        <td ng-bind="permission.name"></td>
                                        <td ng-bind="permission.description"></td>
                                    </tr>
                                </tbody>
                                <tfoot class="hide-if-no-paging">
                                    <tr>
                                        <td colspan="5" class="text-center">
                                            <button type="button" class="btn btn-success pull-left" ng-click="updateRolePermission(permission.currentRole)">Update</button>
                                            <button type="button" class="btn btn-primary pull-left" ng-click="permission.showRoleDetail = !permission.showRoleDetail">Back</button>
                                        </td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </tab>
    </tabset>

</div>